---
title: "Algoritma Linear Regression dengan R"
date: "`r Sys.Date()`"
author: Aulia Hasna-Institut Teknologi Statistika dan Bisnis Muhammadiyah
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: true
    lightbox: true
    gallery: false
    highlight: tango
bibliography: references.bib
---

```{=html}
<style>
body{
text-align: justify}
</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Algoritma Regresi Linier dengan R
## Pengertian 
Uji statistik yang diterapkan pada kumpulan data untuk mendefinisikan dan mengukur hubungan antara variabel yang dipertimbangkan (chang 2004) 

Regresi linier Merupakan sebuah hitungan statistik untuk menentukan pengaruh antara variabel satu dan yang lainnya (P. Katemba dan R.K Dioh 2017)

# Tahapan Algoritma


# Eksperimen Algoritma 
Seorang peneliti sosial yang tertarik pada hubungan antara pengeluaran dan pengeluaran unruk makan. Variabel independen (pendapatan) dan variabel dependen (pengeluaran untuk makan) keduanya bersifat kuantitatif, sehingga  dapat dilakukan analisis  regresi untuk melihat apakah ada hubungan linear antara mereka.

lalu masukan dataset
```{r}
 library(PoEdata) # load the library PoEdata
library(DT) # use for datatable function
 data("food", package="PoEdata")
 datatable(food)
 

```
```{r}
plot(food$income, food$food_exp,
     ylim=c(0, max(food$food_exp)),
     xlim=c(0, max(food$income)),
     xlab="weekly income in $100",
     ylab="weekly food expenditure in $", type = "p")
```


**Estimasi Linier Regresi** 

Y = b1 + b2 * X + e
foodexp = b1 + b2 * income + e

```{r}
mod1 <- lm(food_exp ~income, data = food) # linear model 
smod1<- summary(mod1) # get summary
smod1


```
```{r}
b1 <- coef(mod1)[[1]] #the estimated value of b1
b2 <- coef(mod1)[[2]]#the estimated value of b2
b1
```
```{r}
b2
```

yhat = b1 + b2 * X
foodexp = 83.416 + 10.20964 * income

```{r}
plot(food$income, food$food_exp,
xlab="weekly income in $100",
ylab="weekly food expenditure in $", type="p")
abline(b1,b2)
```

```{r}
mod1$coefficients
```
```{r}
smod1$coefficients
```
**Prediksi Menggunakan SLR Model**

foodexp = 83.416 + 10.20964 * 20
        = $287.608861
```{r}
mod1 <- lm(food_exp~income, data=food)
newx <- data.frame(income = c(20, 25, 27))
yhat <- predict(mod1, newx)
yhat #print the result
```
**Assesment Koefisien Regresi**
```{r}
N <- nrow(food) # returns the numbr of observations in the dataset
C <- 50 #desired number of subsamples
S <- 38 # desired sample size


sumb2 <- 0
for (i in 1:C) {set.seed(3*i)
  subsample <- food[sample(1:N, size=S, replace=TRUE),]
  mod2 <- lm(food_exp~income, data=subsample)
  # sum b2 for all subsamples :
  sumb2 <- sumb2 + coef(mod2)[[2]]
}
print(sumb2/C, digits = 3)
```
hasilnya, b2 = 9.88 adalah rata-rata dari 50 perkiraan b2

**Estimasi var dan cov**
```{r}

```


# Referensi
https://rpubs.com/dsciencelabs/econometrics2

